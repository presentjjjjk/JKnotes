# 简单固体的DFT计算

## 晶格参数优化

不断改变晶格参数a或者c,计算晶体的总能量,找到能量最低的那个.

由于周期性体系的单点能计算是一件相当耗时的事情,所以可以计算能量最低点附近的几个点,然后进行拟合,拟合的模型可以这样得到,考虑E在a=a0处进行泰勒展开:

$$
E_{tot}(a)=E_{tot}(a_0)+\frac{dE}{da}(a-a_0)+\frac{d^2E}{da^2}(a-a_0)^2
$$

由于能量最低点梯度为0,所以拟合模型为:

$$
E=E_{tot}+\beta(a-a_0)^2
$$

然后算几个点拟合一下上面的系数,就可以得到最优晶格参数.

以铜为例,铜是FCC晶体,原胞中只有一个Cu,晶格矢量为((1/2,1/2,0),(1/2,0,1/2),(0,1/2,1/2))*a,金属是闭壳层体系,其最优晶格参数大约在3.62A,所以在这个点附近采样(如果事先不知道实验值,可以先扫描一个比较大的范围,确定极小点大致在哪里).

更加精确的模型是BM状态方程,其适用于各向同性的固体:

$$
E_{tot}=E_0+\frac{9V_0B_0}{16}\{ [(\frac{a_0}{a})^2-1]^3B_0'+[(\frac{a_0}{a})^2-1]^2[6-4(\frac{a_0}{a})^2] \}
$$

使用这个状态方程在外推的时候可以获得与实验值较为符合的结果.

或者,上述问题实际上只是一个一维优化问题,也可以直接跑牛顿法获得极小点,但是面对大规模优化的时候,扫描还是很有必要的.

## 练习

1. 通过计算确定Pt在简单立方,FCC,HCP中更加接近哪一种,并且将DFT计算的参数和实验值比较
2. Hf在实验上被确定为HCP金属,c/a=1.58,尝试用DFT计算预测晶格参数并且与实验值比较.
3. 许多化学配比为AB的固体都表现为CsCl结构,在此结构中A为简单立方排布,B位于A立方体的中心,尝试确定CsCl结构的晶格矢量和分数坐标,并且使用这一结构预测ScAl的晶格参数
4. AB化合物还有一种常见的结构就是NaCl结构,A,B交替形成简单立方晶体,尝试求解ScAl在这种结构下的晶格参数,与上一问的结果进行比较.

值得注意的是,晶体计算的输入文件依赖的是对称性,不会显式的在cif文件中写出有几个原子在晶胞中,因此,不太推荐手动去改输入文件,容易出错,直接使用vesta修改点群对称性,就可以得到不同结构的晶体(Edit data-Unit cell).

### practice_1

FCC结构的Pt的对称性为Fm-3m,简单立方结构的Pt的对称性为Pm-3m,另一个HCP结构则是要修改成为六方晶系,对称性改成P6,使用Multiwfn执行晶胞和原子结构优化任务,比较三种结构的单点能.

k点规格为[12,12,12],基组采用tzvp-DZVP-MOLOPT-SR-GTH-q18,赝势采用GTH-PBE,泛函也采用PBE.

优化结果如下所示,其中HCP因为是二维优化,要耗时的多:

(为了可比性,表格中的能量均为能量密度,即总能量除以晶胞内的原子个数,即单个原子的能量)

|结构|晶格参数/A|能量/a.u.|
|--|--|--|
|Cube|   2.627|  -120.172|
|FCC|  3.97 |-120.190 |
|HCP|a=2.695,c=2.684|-120.185|

可以看出,FCC结构的晶体能量是最低的,但是三者能量的差距没有很大,其中HCP结构和FCC的能量非常接近,这进一步佐证了HCP和FCC两种结构有很多相似性的观点.

### practice_2

计算结果为:

```
 CELL| Vector a [angstrom]:       2.993     0.000     0.000   |a| =     2.993433
 CELL| Vector b [angstrom]:      -1.503     2.589     0.000   |b| =     2.993312
 CELL| Vector c [angstrom]:      -0.000    -0.000     6.036   |c| =     6.036458
```
c/a=2.016,这个和实验值差的有点多.

### practice_3

计算结果:

CsCl:

```
CELL| Vector a [angstrom]:       4.198     0.000     0.000   |a| =     4.198391
CELL| Vector b [angstrom]:       0.000     4.198     0.000   |b| =     4.198391
CELL| Vector c [angstrom]:       0.000     0.000     4.198   |c| =     4.198391
```
三个晶格参数相同,实验值为4.085,与实验值相差大约为0.1.

ScAl:

```
 CELL| Vector a [angstrom]:       3.379     0.000     0.000   |a| =     3.378919
 CELL| Vector b [angstrom]:       0.000     3.379     0.000   |b| =     3.378919
 CELL| Vector c [angstrom]:       0.000     0.000     3.379   |c| =     3.378919
 ENERGY| Total FORCE_EVAL ( QS ) energy [a.u.]:              -48.775872452065627
```

### practice_4

NaCl结构的ScAl计算结果如下所示:

```
 CELL| Vector a [angstrom]:       5.657     0.000     0.000   |a| =     5.657388
 CELL| Vector b [angstrom]:       0.000     5.657     0.000   |b| =     5.657387
 CELL| Vector c [angstrom]:       0.000     0.000     5.657   |c| =     5.657388
 ENERGY| Total FORCE_EVAL ( QS ) energy [a.u.]:             -194.936162297137798
```

除以4之后得到能量密度为-48.734a.u.,不如上面的CsCl结构的要来的低,所以可以做出预测,ScAl的晶体结构为CsCl型




