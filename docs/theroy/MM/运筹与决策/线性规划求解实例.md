# 线性规划求解实例

## 基于Python的求解

在Python中,线性规划的标准形式是由目标函数,一个等式约束,一个不等式约束,以及决策变量的上下界约束构成的

$$
\begin{aligned}
\min c^T x \\
s.t. A_{ub}x\le b_{ub}\\
A_{eq}x=b_{eq}\\
l\le x\le u
\end{aligned}
$$

通常调用的是SciPy库中的linprog函数:

```python

from scipy.optimize import linprog

res=linprog(c, A_ub=A_ub, b_ub=b_ub, A_eq=A_eq, b_eq=b_eq, bounds=x_bounds, method='highs')
```
res返回的是一个optimize对象,他有如下属性:

![alt text](image-28.png)

最后一项的method表示求解的方式,这里我们使用highs方法，它是SciPy最新的推荐方法。

下面直接来看例子:

### 生产问题

某个生产商根据以前的生产情况预测了下一个月每个星期的需求量以及工厂的生产能力,工厂可以提前完成生产(即某一周生产部分下一周的产品),但是,如果生产出来的产品在当周没有卖完,那么就需要额外花费0.2千元的单价去储存商品,该生产商的商品在第四周必须要卖完,没有剩余,问,生产商要如何调配各个周的生产量?

![alt text](image-33.png)

每周的生产数目设为$x_1,x_2,x_3,x_4$,每周的生产剩余为$y_1,y_2,y_3,y_4$,根据条件$y_4=0$,x和y的关系是:

$$
\begin{aligned}
x_1-y_1=15 \\
x_2+y_1-y_2=25\\
x_3+y_2-y_3=35\\
x_4+y_3=25
\end{aligned}
$$

上下界约束为:

$$
\begin{aligned}
0\le x_1\le 30\\
0\le x_2\le 40 \\
0\le x_3\le 45\\
0\le x_4\le 20\\
y_1\ge 0\\
y_2\ge 0\\
y_3\ge 0
\end{aligned}
$$

目标函数为:

$$
\min z=5x_1+5.1x_2+5.4x_3+5.5x_4+0.2(y_1+y_2+y_3)
$$

```python
from scipy.optimize import linprog
import numpy as np

c=np.array([5,5.1,5.4,5.5,0.2,0.2,0.2])

A_eq=np.array([[1,0,0,0,-1,0,0],
               [0,1,0,0,1,-1,0],
               [0,0,1,0,0,1,-1],
               [0,0,0,1,0,0,1]])

b_eq=np.array([15,25,35,25])

#上下界约束,如果某一个没有就写None或者np.inf

x_bounds = [(0, 30), (0, 40), (0, 45), (0, 20), (0, None), (0, np.inf), (0, np.inf)]

res=linprog(c=c, A_eq=A_eq, b_eq=b_eq, bounds=x_bounds, method='highs')

if res.success:
    print('最优值',res.fun)
    print('最优解',res.x)
else:
    print('求解失败')

```

运行结果为:

![alt text](image-29.png)

最优值是正确的,但是最优解和书上不一样,也许不止一个最优解?

